% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/go_enrichment.R
\name{go_enrichment}
\alias{go_enrichment}
\title{GO enrichment with topGO (DAG-aware) for query/subject columns}
\usage{
go_enrichment(
  dnds_annot_file = NULL,
  comparison_file = NULL,
  output_dir = getwd(),
  sides = c("query", "subject"),
  ontologies = c("BP", "MF", "CC"),
  algorithm = c("weight01", "elim", "classic", "weight"),
  statistic = c("fisher", "ks"),
  pos_threshold = 1,
  max_dnds = 10,
  filter_expr = NULL,
  drop_rows_without_go = TRUE,
  node_min = 10,
  node_max = Inf,
  p_adjust = c("BH", "none"),
  make_plots = TRUE,
  top_n = 20,
  exclude_gos = NULL,
  exclude_descendants = FALSE,
  exclude_descendants_depth = Inf,
  exclude_descendants_limit = 5000,
  include_definition = TRUE
)
}
\arguments{
\item{dnds_annot_file}{Path to single <comp>_dnds_annot.tsv (single mode).}

\item{comparison_file}{Batch mode: whitespace-delimited file with
columns: comparison_name, query_fasta, query_gff, subject_fasta, subject_gff.}

\item{output_dir}{Root directory that contains per-comparison folders (batch mode).}

\item{sides}{c("query","subject") which side(s) to analyze.}

\item{ontologies}{c("BP","MF","CC") which GO branches.}

\item{algorithm}{topGO algorithm: one of "weight01","elim","classic","weight".}

\item{statistic}{topGO statistic: usually "fisher" (default) or "ks".}

\item{pos_threshold}{Numeric; dNdS > pos_threshold defines "positive" (default 1).}

\item{max_dnds}{Drop rows with dNdS >= max_dnds or NA (default 10).}

\item{filter_expr}{Optional character filter evaluated in the data
(e.g., "q_seqname == s_seqname").}

\item{drop_rows_without_go}{If TRUE (default), universe is genes with â‰¥1 GO for that side.}

\item{node_min}{Minimum term size (topGO nodeSize) to keep (default 10).}

\item{node_max}{Maximum term size (filtered after test; default Inf).}

\item{p_adjust}{"BH"|"none" for multiple-testing correction across tested nodes.}

\item{make_plots}{If TRUE, writes a top-N bubble plot per result.}

\item{top_n}{Number of rows to plot.}

\item{exclude_gos}{Character vector of GO IDs to exclude globally
from positives/background and from tested nodes (default NULL).}

\item{exclude_descendants}{If TRUE, also exclude descendants of each GO ID (default FALSE).}

\item{exclude_descendants_depth}{Integer depth limit for descendant exclusion;
1 = direct children only, Inf = entire subtree (default Inf).}

\item{exclude_descendants_limit}{Hard cap on total excluded nodes per (side,ontology)
run to avoid accidentally nuking huge swaths (default 5000).}

\item{include_definition}{If TRUE (default), append TERM definition from GO.db.}
}
\value{
Invisibly: vector of output TSV paths (batch) or a data.frame list (single if make_plots=FALSE).
}
\description{
Uses topGO algorithms (classic/elim/weight/weight01) to test enrichment of GO terms
among positively selected pairs (dNdS > pos_threshold) vs background, with an
annotation-aware universe (drop rows with no GO for that side) by default.
}

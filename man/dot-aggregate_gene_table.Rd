% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dnds_state_contrast.R
\name{.aggregate_gene_table}
\alias{.aggregate_gene_table}
\title{Aggregate gene rows to gene-level table (per gene_key + group)}
\usage{
.aggregate_gene_table(
  g,
  group_mode = c("subgenome", "custom"),
  group_col = NULL,
  agg_fun = c("median", "mean"),
  min_pairs = 2,
  random_effect_col = NULL
)
}
\description{
Random effects:
\itemize{
\item Only retained if random_effect_col is constant within each gene_key.
\item If it varies within gene_key (common for orthogroup-per-pair), it is disabled with a warning.
}
}
\details{
Safety:
\itemize{
\item In group_mode="subgenome", if any groups cannot be inferred, this function STOPs
with example seqnames to prevent silent gene loss.
}
}
\keyword{internal}

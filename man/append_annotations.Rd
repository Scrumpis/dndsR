% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/append_annotations.R
\name{append_annotations}
\alias{append_annotations}
\title{Append annotations from query & subject GFFs to dN/dS results}
\usage{
append_annotations(
  dnds_file = NULL,
  query_gff = NULL,
  subject_gff = NULL,
  output_file = NULL,
  comparison_file = NULL,
  output_dir = getwd(),
  custom = NULL,
  threads = NULL,
  overwrite = FALSE
)
}
\arguments{
\item{dnds_file}{Path to a dN/dS TSV (single mode). Must contain columns
\code{query_id} and \code{subject_id}.}

\item{query_gff}{Path to a query GFF3 file (single mode).}

\item{subject_gff}{Path to a subject GFF3 file (single mode).}

\item{output_file}{Optional output path (single mode). If \code{NULL}, returns
the annotated data.frame instead of writing to disk.}

\item{comparison_file}{Path to a whitespace-delimited file (tabs/spaces; header or not)
with columns: \code{comparison_name}, \code{query_fasta}, \code{query_gff},
\code{subject_fasta}, \code{subject_gff}. If provided, batch mode is used and
outputs are written beside each per-comparison dN/dS file.}

\item{output_dir}{Root directory containing per-comparison folders (batch mode).}

\item{custom}{Optional comma-separated patterns like \code{"REX{5},TOM{8}"} meaning
PREFIX followed by exactly N digits; produces \code{q_<prefix>} / \code{s_<prefix>}
columns (lowercased) when present.}

\item{threads}{Integer threads to use for per-ID annotation. If \code{NULL}/\code{NA},
uses \code{options(dndsR.threads)} or \code{DNDSR_THREADS}; defaults to 1.}

\item{overwrite}{Logical; in batch mode, skip a comparison if output exists unless
\code{TRUE}. Default \code{FALSE}.}
}
\value{
In single mode: a data.frame (unless \code{output_file} is provided, in which
case the output path is returned). In batch mode: (invisibly) a character vector
of output paths.
}
\description{
Appends annotation strings and extracted term IDs (e.g., InterPro/IPR, GO) from
query and subject GFF3 files onto a dN/dS results table. Supports single-file
mode and batch mode via a comparison table.
}
\details{
In batch mode, each comparison is expected at:
\code{file.path(output_dir, comparison_name, paste0(comparison_name, "_dnds.tsv"))}.
The annotated output is written as \code{<comparison_name>_dnds_annot.tsv} in the
same folder.

Verbose messages can be enabled with \code{options(dndsR.verbose = TRUE)} (or
\code{options(dndsR.cli.verbose = TRUE)}).
}

% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/regional_dnds.R
\name{regional_dnds_summary}
\alias{regional_dnds_summary}
\title{Regional dN/dS summaries and region vs background tests}
\usage{
regional_dnds_summary(
  dnds_annot_file = NULL,
  comparison_file = NULL,
  output_dir = getwd(),
  regions_bed,
  region_seq_col = NULL,
  region_start_col = NULL,
  region_end_col = NULL,
  region_name_col = NULL,
  sides = c("query", "subject"),
  filter_expr = NULL,
  max_dnds = 10,
  make_plots = TRUE,
  ci_method = c("normal", "bootstrap"),
  n_boot = 1000
)
}
\arguments{
\item{dnds_annot_file}{Path to a single \if{html}{\out{<comp>}}_dnds_annot.tsv (single mode).}

\item{comparison_file}{Path to whitespace-delimited file (tabs/spaces; header or not)
with columns: comparison_name, query_fasta, query_gff, subject_fasta, subject_gff.
If provided, batch mode reads:
file.path(output_dir, comparison_name, paste0(comparison_name, "_dnds_annot.tsv")).}

\item{output_dir}{Root directory containing per-comparison folders (batch mode).}

\item{regions_bed}{Path to BED-like file of regions with at least 3 columns:
seqname, start, end, and optionally a name/label column.}

\item{region_seq_col, region_start_col, region_end_col, region_name_col}{Column names in regions_bed for seqname/start/end/label (default: first three +
optional "region_name").}

\item{sides}{Character vector among c("query","subject") indicating which genome
side to use for overlap (default both). Coordinates are taken from
q_seqname/q_start/q_end or s_seqname/s_start/s_end.}

\item{filter_expr}{Optional character with a logical expression evaluated in the data
(e.g., "q_seqname == s_seqname & dNdS < 5").}

\item{max_dnds}{Numeric. Drop rows with dNdS >= max_dnds or NA dNdS (default 10).}

\item{make_plots}{Logical; if TRUE, write box/violin plots per comparison (default TRUE).}

\item{ci_method}{One of "normal" (mean +/- 1.96*SE) or "bootstrap" for 95\% CI.}

\item{n_boot}{Number of bootstrap resamples if ci_method = "bootstrap" (default 1000).}
}
\value{
Invisibly, in single mode: path to summary TSV.
In batch mode: vector of summary TSV paths.
Each TSV contains, per comparison x side x region_status:
comparison, side, region_status, n, mean_dnds, median_dnds,
sd_dnds, se_dnds, ci_lower, ci_upper, p_value (region vs background).
}
\description{
For each dNdS annotation file, label rows as inside/outside a set of genomic
regions and summarize dN/dS distributions by region_status. Optionally tests
whether dN/dS differs between genes inside vs outside the regions using
Wilcoxon rank-sum tests.
}
\details{
Works in single mode (dnds_annot_file) or batch mode (comparison_file +
output_dir), mirroring other dndsR commands.
}

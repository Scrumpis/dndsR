% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculate_dnds.R
\name{calculate_dnds}
\alias{calculate_dnds}
\title{Calculate dN/dS from pre-extracted CDS FASTAs using orthologr}
\usage{
calculate_dnds(
  comparison_file = NULL,
  comparison_name = NULL,
  subject_fasta = NULL,
  query_fasta = NULL,
  subject_gff = NULL,
  query_gff = NULL,
  output_dir = getwd(),
  comp_cores = 4,
  aligner = "diamond",
  sensitivity_mode = "fast",
  dnds_method = "Comeron",
  ...
)
}
\arguments{
\item{comparison_file}{Path to a whitespace-delimited (tabs/spaces) file OR a data.frame
with columns: \code{comparison_name}, \code{query_fasta}, \code{query_gff},
\code{subject_fasta}, \code{subject_gff}. If provided, batch mode is used.}

\item{comparison_name}{Name for the comparison (single mode). Used as the per-comparison
folder name under \code{output_dir} and as the output TSV basename.}

\item{subject_fasta}{Path to the original subject FASTA (single mode). Used only to derive
the expected CDS filename \code{<basename>_CDS.fasta} under the comparison folder.}

\item{query_fasta}{Path to the original query FASTA (single mode). Used only to derive
the expected CDS filename \code{<basename>_CDS.fasta} under the comparison folder.}

\item{subject_gff}{Path to subject GFF3 (single mode). Currently not used by this function,
but accepted for consistency with comparison tables.}

\item{query_gff}{Path to query GFF3 (single mode). Currently not used by this function,
but accepted for consistency with comparison tables.}

\item{output_dir}{Root directory containing per-comparison folders. Each run uses
\code{file.path(output_dir, comparison_name)}.}

\item{comp_cores}{Integer number of CPU cores to pass to \code{orthologr::dNdS()}
as \code{comp_cores}. Default 4.}

\item{aligner}{Character. Aligner passed to \code{orthologr::dNdS()} (e.g. \code{"diamond"}).
If \code{"diamond"}, the \code{diamond} binary must be available on \code{PATH}.}

\item{sensitivity_mode}{Character. Passed to \code{orthologr::dNdS()} as \code{sensitivity_mode}
(e.g. \code{"fast"}).}

\item{dnds_method}{Character. Passed to \code{orthologr::dNdS()} as \code{dnds_est.method}
(e.g. \code{"Comeron"}).}

\item{...}{Additional arguments forwarded to \code{orthologr::dNdS()}. Only named arguments
that match \code{formals(orthologr::dNdS)} are forwarded. If an argument overlaps a default
set by this wrapper, it will override the wrapper default.}
}
\value{
(Invisibly) a character vector of output TSV paths (batch mode), or a single
output TSV path (single mode). Comparisons that are skipped due to missing CDS files
are omitted.
}
\description{
Runs \code{orthologr::dNdS()} on per-comparison CDS FASTA files that are expected to
already exist on disk. Supports batch mode via a comparison table or single-run mode
via explicit arguments.
}
\details{
Expected input CDS FASTAs (per comparison) are:
\itemize{
\item \code{file.path(output_dir, comparison_name, paste0(basename(query_fasta_noext), "_CDS.fasta"))}
\item \code{file.path(output_dir, comparison_name, paste0(basename(subject_fasta_noext), "_CDS.fasta"))}
}
If either CDS file is missing, the comparison is skipped (returns \code{NULL} for that run).
If the output TSV already exists, the run is skipped and the existing path is returned.

This function requires the \pkg{orthologr} package. For Biostrings >= 2.77.1,
alignment helpers were moved into \pkg{pwalign}; this function applies a small shim
to keep older \pkg{orthologr} code working.
}
